# 在json和Text中定义交互模型

通过Alexa技能套件，您可以通过创建自定义技能为Alexa添加新功能。 创建自定义技能时，您将实现该技能的逻辑，还可以定义用户与该技能交互的语音接口。 要定义语音接口，您可以将用户的口头输入映射到您的基于云的服务可以处理的意图。

要声明此映射，您提供以下输入：
1. 意图：意图表示满足用户口头请求的动作。 意图可以可选地具有称为插槽的参数。 意图在称为意图模式的JSON结构中指定。
2. 示例说话：一组可能的口头短语映射到意图。 这应该包括尽可能多的代表性短语。
3. 自定义插槽类型：插槽可能的值的代表性列表。 自定义插槽类型用于未被Amazon内置插槽类型覆盖的项目列表。
4. 对话模型（可选）：一种结构，用于识别您的技能和用户之间进行多方交谈的步骤，以收集完成每个意图所需的所有信息。 这简化了您需要编写的代码来询问用户的信息。


您可以在交互模型页面的开发者门户中输入此信息。 有关详细信息，请参阅[在开发者门户中注册和管理自定义技能](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/registering-and-managing-alexa-skills-in-the-developer-portal)。

以下部分说明如何使用这些资源来定义有效的语音接口。 如果您的技能还具有屏幕界面，则您的语音界面也必须设计为也可以使用屏幕。 请参阅：[语音设计指南](https://developer.amazon.com/designing-for-voice/)。

## 意图模型
意图表示满足用户口头请求的动作。 意图可以可选地具有称为插槽的参数。 例如，“每日占星”的意图模式可能会定义一个名为`GetHoroscope`的意图，其中有一个名为`Sign`和`Date`的插槽。 用户可以说：

> User: Alexa, ask Daily Horoscopes for the horoscope for Pisces today.（Alexa，“每日占星”今天为双鱼座的星座）

Alexa服务在“每日星座”服务中发送一个`GetHoroscope`意图，在`Sign`插槽中的“双鱼座”值和`Date`插槽中的当前日期。 然后，服务可以查看今天的双鱼星座，并发回文本转换为说话。

您可以在称为意图模式的JSON结构中定义一组有效意图。 例如，以下意图模型定义了两个意图：`GetHoroscope`和`GetLuckyNumbers`：

```json
{
  "intents": [
    {
      "intent": "GetHoroscope",
      "slots": [
        {
          "name": "Sign",
          "type": "LIST_OF_SIGNS"
        },
        {
          "name": "Date",
          "type": "AMAZON.DATE"
        }
      ]
    },
    {
      "intent": "GetLuckyNumbers"
    }
  ]
}
```
每个意图都有两个属性：
- `intent`属性给出了意图的名称。
- `slots`属性列出与该意图相关联的插槽。

在上述示例中，`GetHoroscope`意图定义了两个插槽，一个命名为`Sign`，另一个命名为`Date`。

槽是用不同的类型定义的。 例如，上述示例中的`Sign`插槽被定义为自定义类型`LIST_OF_SIGNS`以引用为插槽（白羊座，摩羯座等）提供的星座符号值的列表。 日期插槽使用亚马逊的内置[`AMAZON.DATE`](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/built-in-intent-ref/slot-type-reference#date)类型来转换表示日期的字词（如“今天”）的日期格式。

请注意，Alexa技能工具包提供了一个[内置意图库](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/built-in-intent-ref/built-in-intent-library)，用于常见的操作。 如果要实现这些，您可以将它们包含在您的意图模式中，就像您自己的定制意图一样。 有关详细信息，请参阅实现[内置意图](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/implementing-the-built-in-intents)。


## 插槽类型
包含在意图中的每个插槽必须具有插槽类型。 这可以是内置插槽类型或自定义插槽类型。

### [内置插槽类型](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/defining-the-voice-interface#built-in-slot-types)

亚马逊为大型[插槽类型库](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/built-in-intent-ref/slot-type-reference)提供内置支持。 这包括：
- 转换日期和数字等数据的[类型](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/built-in-intent-ref/slot-type-reference#numbers-dates-and-times)
- 为[值列表](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/built-in-intent-ref/slot-type-reference#list-types)提供识别的类型。 例如，名字或城市名称。

所有内置类型都有前缀`AMAZON`。

> 提示：有关所有内置插槽类型和示例的完整列表，请参阅[插槽类型参考](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/built-in-intent-ref/slot-type-reference)。

您不需要为内置插槽类型提供样品值。根据需要，在示例语音文件中包含插槽名称。对于其他数据类型，建议使用自定义插槽类型。

仅支持英文（美国）技能的附加内置插槽类型：`AMAZON.LITERAL`。此类型主要用于与早期版本的Alexa技能工具包兼容。

> 注意：根据开发人员的反馈，`AMAZON.LITERAL`插槽未如
前所述被删除。您可以继续使用`AMAZON.LITERAL`提交新的和更新的英语（美国）技能。但是，在许多情况下，自定义插槽类型提供比`AMAZON.LITERAL`更好的准确性，因此我们建议您尽可能考虑[迁移到自定义插槽类型](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/migrating-to-the-improved-built-in-and-custom-slot-types#literal)。

> 英语（英国）和德国技能不支持`AMAZON.LITERAL`，不能使用`AMAZON.LITERAL`插槽类型。

请注意，从早期版本的Alexa技能工具包开始，插槽类型行为已更改。有关差异，向后兼容性和从以前版本迁移技能的信息，请参阅[迁移到改进的内置和自定义插槽类型](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/migrating-to-the-improved-built-in-and-custom-slot-types)。

### [自定义插槽类型](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/defining-the-voice-interface#custom-slot-types)

自定义插槽类型定义插槽的代表性值列表。 自定义插槽类型用于亚马逊[内置的一组类型](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/built-in-intent-ref/slot-type-reference)不包含的项目列表，并且对于大多数用例而言是推荐的。 使用自定义类型时，可以定义类型及其值，并将该类型的名称指定为intent定义的一部分。

例如，星座技能的自定义插槽类型可能命名为`LIST_OF_SIGNS`，并具有以下值：

```json
Aries
Taurus
Gemini
Cancer
Leo
Pisces
Virgo
Libra
Scorpio
Sagittarius
Capricorn
Aquarius
```
只要用户可以使用这个插槽，技能的处理可以支持一组自定义值，尽管在技术语言的典型字典中找不到字词可能无法识别。

插槽值以书面形式发送给您的技能。例如，`“fire h.d. 7“`和`”Fire h.d.7“`将被发送到你的技能`”Fire HD7“`。为了更好地识别，首字母缩略语和其他涉及口头信件的短语应该是全部上限（“HD”），或者按句点分隔（“h.d.”）。使用小写的初始化可能导致不可靠的识别，因为可能无法正确检测到口头表单。参见[例子](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/alexa-skills-kit-interaction-model-reference#custom-slot-type-values)。

请注意，自定义插槽类型不等同于枚举。如果语言理解系统被认可，列表之外的值仍然返回。虽然对自定义插槽类型的输入被加权到列表中的值，但它不仅限于列表中的项目。您的代码仍然需要在使用插槽值时包括验证和错误检查。请参阅[Alexa发送的处理请求](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/handling-requests-sent-by-alexa)中的“处理可能的输入错误”部分。

有关自定义插槽类型值的建议，请参阅[自定义插槽类型值](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/ask-bp-sample-utterances#h3_custom_slot_values)。

自定义插槽类型可用于多个插槽。例如，假设星座技能有另外的意图，`MatchSign`，比较了两个十二生肖。这个意图定义了两个插槽，即`FirstSign`和`SecondSign`。这些插槽可以使用相同的自定义`LIST_OF_SIGNS`插槽类型：
```json
{
  "intents": [
    {
      "intent": "GetHoroscope",
      "slots": [
        {
          "name": "Sign",
          "type": "LIST_OF_SIGNS"
        },
        {
          "name": "Date",
          "type": "AMAZON.DATE"
        }
      ]
    },
    {
      "intent": "MatchSign",
      "slots": [
        {
          "name": "FirstSign",
          "type": "LIST_OF_SIGNS"
        },
        {
          "name": "SecondSign",
          "type": "LIST_OF_SIGNS"
        }
      ]
    },
    {
      "intent": "GetLuckyNumbers"
    }
  ]
}
```

## 示例语言

每个可能的样本说话都被分配给一个定义的意图。 例如，以下来自示例说话文件的片段将四个可能的短语映射到`GetHoroscope`意图，两个短语到`GetLuckyNumbers`意图，以及两个短语到`MatchSign`意图（实际上，需要更多的话语，而不是显示在本示例中）：
```json
GetHoroscope what is the horoscope for {Sign}
GetHoroscope what will the horoscope for {Sign} be on {Date}
GetHoroscope get me my horoscope
GetHoroscope {Sign}
...
GetLuckyNumbers what are my lucky numbers
GetLuckyNumbers tell me my lucky numbers
...
MatchSign do {FirstSign} and {SecondSign} get along
MatchSign what is the relationship between {FirstSign} and {SecondSign}
```
请注意，您不需要为任何[内置的意图](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/built-in-intent-ref/built-in-intent-library)（如`AMAZON.HelpIntent`）提供示例语句。

### [示例语法](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/defining-the-voice-interface#sample-utterance-syntax)

示例语句文件的每一行由两个由选项卡或空格分隔的字段组成：
- 在左边的意图的名称。
- 用户可能会在右侧表示意图的短语。

插槽是意图的参数。 在每个示例语句中，对于除`AMAZON.LITERAL`之外的所有插槽类型，以花括号表示插槽值作为插槽名称：`{SlotName}`。 `AMAZON.LITERAL`插槽类型还需要插槽的字数值：`{slot value | SlotName}`。
例如，在文件中考虑这个示例：
> "what will the horoscope for {Sign} be on {Date}" 

在这个话语中，插槽`{Sign}`和`{Date}`作为`GetHoroscope`意图的参数，并被放在这个话语模式中作为变量。 `{Sign}`的可能值取自自定义列表`LIST_OF_SIGNS`，`{Date}`的可能值取自Alexa Skill Kit对日期的内置支持。 这允许用户给出如下输入：
> "what will the horoscope for Leo be on Tuesday" 

Alexa技能套件基于自定义和内置插槽类型自动泛化输入，因此只需指定一种模式就可以针对该模式进行所有形式的输入。 然而，考虑语言模式的变化仍然很重要。 例如，涵盖以下话语：
> "what will the horoscope for libra be tomorrow" 

应该在示例语句文件中添加以下模式（不再需要“on”）：
>"what will the horoscope for {Sign} be {Date}". 

有关指定说话模式的更多指导，请参阅[示例语言和自定义插槽类型值的最佳做法](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/ask-bp-sample-utterances)。
单独的话语不需要使用为意图定义的每个插槽。 上述示例中显示的`GetHoroscope`意图模式定义了一个`Sign`插槽和一个`Date`插槽。 话语“`what is the horoscope for {Sign}`”只使用了`Sign`插槽，而说话“`get me my horsocope`”根本就不使用任何插槽。 当用户说出这些短语时，发送相同的意图，但是具有`null`插槽值。

作为一般做法，请注意拼写错误和拼写错误。 不要忘记在“什么”和“谁是谁”中的撇号（'），并注意直接从书面语言来源复制和粘贴引入的错误。
## 下一步

- 下一页：[了解用户如何调用自定义技能](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/supported-phrases-to-begin-a-conversation)
- 回到：[建立自定义技能的步骤](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/overviews/steps-to-build-a-custom-skill)
- 另请参阅：[自定义交互模型参考](https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/alexa-skills-kit-interaction-model-reference)